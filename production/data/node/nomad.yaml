---
profiles::orchestration::consul::config:
  addresses: {
    http: '127.0.0.1 %{::ipaddress_eth1}'
  }
  bootstrap_expect: 1
  server: true
  ui: true
profiles::orchestration::consul::server: true
profiles::orchestration::consul::services:
  consul-ui:
    checks:
      - http: 'http://127.0.0.1:8500'
        interval: 10s
    port: 8500
    tags:
      - "consul"
      - "sd"
      - "traefik.enable=true"
      - "traefik.frontend.rule=Host:consul.traefik"
      - "traefik.frontend.auth.basic=admin:$apr1$X3YoCPnq$HH/fha9lWqt.zPCmdbSL90"
  nomad-ui:
    checks:
      - http: 'http://%{::ipaddress_eth1}:4646'
        interval: 10s
    port: 4646
    tags:
      - "nomad"
      - "scheduler"
      - "traefik.enable=true"
      - "traefik.frontend.rule=Host:nomad.traefik"
      - "traefik.frontend.auth.basic=admin:$apr1$X3YoCPnq$HH/fha9lWqt.zPCmdbSL90"
  vault-ui:
    checks:
      - http: 'http://%{::ipaddress_eth1}:8200'
        interval: 10s
    port: 8200
    tags:
      - "vault"
      - "security"
      - "traefik.enable=true"
      - "traefik.frontend.rule=Host:vault.traefik"
profiles::orchestration::consul::ui: true
profiles::runtime::docker: false
profiles::scheduling::nomad: true
profiles::scheduling::nomad::config:
  client:
    enabled: false
  server:
    enabled: true
    bootstrap_expect: 1
  vault:
    create_from_role: nomad-cluster
    token: 's.MR0LwJbN9KbwP5EufWqZkZ48'
profiles::security::vault: true
profiles::security::vault::extra_config:
  api_addr: 'https://%{::ipaddress_eth1}:8200'
  cluster_addr: 'https://%{::ipaddress_eth1}:8201'
profiles::security::vault::listener:
  tcp:
    address: '%{::ipaddress_eth1}:8200'
    cluster_address: '%{::ipaddress_eth1}:8201'
    tls_disable: 1
profiles::security::vault::storage:
  consul:
    address: '127.0.0.1:8500'
    path: 'vault/'
...
